create_fae_avelwynn_effect = {
	custom_tooltip = create_avelwynn
	show_as_tooltip = {
		every_held_title = {
			custom = create_avelwynn_every_held_kingdom
			limit = {
				tier = tier_kingdom
			}
			custom_tooltip = create_avelwynn_de_jure_changes
		}
	}

	hidden_effect = {
		save_scope_as = founder
		primary_title = {
			save_scope_as = old_title
		}

		create_title_and_vassal_change = {
			type = created
			save_scope_as = change
			add_claim_on_loss = no
		}

		title:e_avelwynn = {
			change_title_holder = {
				holder = scope:founder
				change = scope:change
			}
		}

		resolve_title_and_vassal_change = scope:change

		title:e_avelwynn = {
			save_scope_as = new_title
			set_capital_county = scope:old_title.title_capital_county
		}

		change_government_to_fae_bureaucratic = yes

		add_realm_law_skip_effects = fae_authority_3
		add_realm_law_skip_effects = fae_single_heir_succession_law
		add_realm_law_skip_effects = female_only_law

  		merge_all_kingdoms_into_singular_empire = yes

		title:e_avelwynn = {
			add_title_law = fae_succession_law	
		}

		set_primary_title_to = title:e_avelwynn

		trigger_event = fae_queen.0001 # Notification event that you've created avelwynn
	}
}

merge_all_kingdoms_into_singular_empire = {
	every_held_title = { # Merges all owned kingdoms into the new empire title
		limit = {
			tier = tier_kingdom
		}

		set_de_jure_liege_title = scope:new_title
	}

	every_held_title = { # Destroys all owned empire titles other than the one that was just created
		limit = {
			tier = tier_empire
			NOT = { this = scope:new_title }
		}

		scope:founder = {
			destroy_title = prev
		}
	}

	every_sub_realm_county = { # Merges all unowned kingdom titles that you completely control into the new empire title
		limit = {
			exists = kingdom
			NOT = { exists = kingdom.holder }
			holder.top_liege = root
			kingdom = {
				save_temporary_scope_as = test_kingdom
			}
			holder.top_liege = {
				completely_controls = scope:test_kingdom
			}
		}
		if = {
			limit = {
				NOT = {
					kingdom = {
						is_in_list = additional_de_jure_kingdoms
					}
				}
			}
			kingdom = {
				set_de_jure_liege_title = scope:new_title
				add_to_list = additional_de_jure_kingdoms
			}
		}
	}
}